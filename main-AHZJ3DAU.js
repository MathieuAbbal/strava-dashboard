import{c as de,e as me,f as y,g as ue,h as he,i as ve,j as fe}from"./chunk-27D2G7FL.js";import{$a as m,A as E,Aa as V,F as T,Ha as j,I as b,Ib as pe,J as Q,L as G,Nb as S,O as X,Oa as ae,P as z,Q as d,Qa as Z,R as ee,Sa as x,Ta as w,V as L,W as P,X as C,Y as D,Ya as q,Z as te,Za as o,_a as a,a as J,ca as ne,db as Y,fa as ie,g as R,ga as re,h as I,hb as O,jb as h,p as g,qb as se,sb as s,ta as K,tb as U,ub as F,va as oe,vb as le,w as v,wa as p,wb as ce,x as B}from"./chunk-XYDX6LLM.js";var $="Service workers are disabled or not supported by this browser",_=class{serviceWorker;worker;registration;events;constructor(r,e){if(this.serviceWorker=r,!r)this.worker=this.events=this.registration=new R(i=>i.error(new b(5601,!1)));else{let i=null,n=new I;this.worker=new R(u=>(i!==null&&u.next(i),n.subscribe(N=>u.next(N))));let l=()=>{let{controller:u}=r;u!==null&&(i=u,n.next(i))};r.addEventListener("controllerchange",l),l(),this.registration=this.worker.pipe(T(()=>r.getRegistration().then(u=>{if(!u)throw new b(5601,!1);return u})));let c=new I;this.events=c.asObservable();let f=u=>{let{data:N}=u;N?.type&&c.next(N)};r.addEventListener("message",f),e?.get(Z,null,{optional:!0})?.onDestroy(()=>{r.removeEventListener("controllerchange",l),r.removeEventListener("message",f)})}}postMessage(r,e){return new Promise(i=>{this.worker.pipe(E(1)).subscribe(n=>{n.postMessage(J({action:r},e)),i()})})}postMessageWithOperation(r,e,i){let n=this.waitForOperationCompleted(i),l=this.postMessage(r,e);return Promise.all([l,n]).then(([,c])=>c)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(r){let e;return typeof r=="string"?e=i=>i.type===r:e=i=>r.includes(i.type),this.events.pipe(B(e))}nextEventOfType(r){return this.eventsOfType(r).pipe(E(1))}waitForOperationCompleted(r){return new Promise((e,i)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(B(n=>n.nonce===r),E(1),g(n=>{if(n.result!==void 0)return n.result;throw new Error(n.error)})).subscribe({next:e,error:i})})}get isEnabled(){return!!this.serviceWorker}},ye=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new I;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=v,this.notificationClicks=v,this.notificationCloses=v,this.pushSubscriptionChanges=v,this.subscription=v;return}this.messages=this.sw.eventsOfType("PUSH").pipe(g(n=>n.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(g(n=>n.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(g(n=>n.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(g(n=>n.data)),this.pushManager=this.sw.registration.pipe(g(n=>n.pushManager));let i=this.pushManager.pipe(T(n=>n.getSubscription()));this.subscription=new R(n=>{let l=i.subscribe(n),c=this.subscriptionChanges.subscribe(n);return()=>{l.unsubscribe(),c.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error($));let i={userVisibleOnly:!0},n=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),l=new Uint8Array(new ArrayBuffer(n.length));for(let c=0;c<n.length;c++)l[c]=n.charCodeAt(c);return i.applicationServerKey=l,new Promise((c,f)=>{this.pushManager.pipe(T(M=>M.subscribe(i)),E(1)).subscribe({next:M=>{this.subscriptionChanges.next(M),c(M)},error:f})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error($));let e=i=>{if(i===null)throw new b(5602,!1);return i.unsubscribe().then(n=>{if(!n)throw new b(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((i,n)=>{this.subscription.pipe(E(1),T(e)).subscribe({next:i,error:n})})}decodeBase64(e){return atob(e)}static \u0275fac=function(i){return new(i||t)(z(_))};static \u0275prov=G({token:t,factory:t.\u0275fac})}return t})(),Se=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=v,this.unrecoverable=v;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error($));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new b(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(i){return new(i||t)(z(_))};static \u0275prov=G({token:t,factory:t.\u0275fac})}return t})(),xe=new X("");function _e(){let t=d(A);if(!("serviceWorker"in navigator&&t.enabled!==!1))return;let r=d(xe),e=d(ne),i=d(Z);e.runOutsideAngular(()=>{let n=navigator.serviceWorker,l=()=>n.controller?.postMessage({action:"INITIALIZE"});n.addEventListener("controllerchange",l),i.onDestroy(()=>{n.removeEventListener("controllerchange",l)})}),e.runOutsideAngular(()=>{let n,{registrationStrategy:l}=t;if(typeof l=="function")n=new Promise(c=>l().subscribe(()=>c()));else{let[c,...f]=(l||"registerWhenStable:30000").split(":");switch(c){case"registerImmediately":n=Promise.resolve();break;case"registerWithDelay":n=ge(+f[0]||0);break;case"registerWhenStable":n=Promise.race([i.whenStable(),ge(+f[0])]);break;default:throw new b(5600,!1)}}n.then(()=>{i.destroyed||navigator.serviceWorker.register(r,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(c=>console.error(Q(5604,!1)))})})}function ge(t){return new Promise(r=>setTimeout(r,t))}function ke(){let t=d(A),r=d(te),e=!0;return new _(e&&t.enabled!==!1?navigator.serviceWorker:void 0,r)}var A=class{enabled;updateViaCache;type;scope;registrationStrategy};function we(t,r={}){return ee([ye,Se,{provide:xe,useValue:t},{provide:A,useValue:r},{provide:_,useFactory:ke},ae(_e)])}function k(){let t=d(S),r=d(y);return t.authenticated()?!0:r.createUrlTree(["/login"])}var Ee=[{path:"login",loadComponent:()=>import("./chunk-XKWS4DS7.js").then(t=>t.Login)},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",canActivate:[k],loadComponent:()=>import("./chunk-27FMTZC4.js").then(t=>t.Dashboard)},{path:"activities",canActivate:[k],loadComponent:()=>import("./chunk-MDKPIH2N.js").then(t=>t.ActivityList)},{path:"activities/:id",canActivate:[k],loadComponent:()=>import("./chunk-Z5GY43WJ.js").then(t=>t.ActivityDetailComponent)},{path:"progression",canActivate:[k],loadComponent:()=>import("./chunk-NWTJMNIO.js").then(t=>t.Progression)},{path:"map",canActivate:[k],loadComponent:()=>import("./chunk-LJNUYIIX.js").then(t=>t.GlobalMap)}];var Ce={providers:[ie(),ve(Ee,fe()),we("ngsw-worker.js",{enabled:!pe(),registrationStrategy:"registerWhenStable:30000"})]};function Te(t,r){if(t&1&&(o(0,"p",29),s(1),a()),t&2){let e=h(2);p(),ce("",e.city,"",e.city&&e.country?", ":"","",e.country)}}function De(t,r){if(t&1&&(o(0,"div",31)(1,"span",32),s(2,"Localisation"),a(),o(3,"span",33),s(4),a()()),t&2){let e=h(2);p(4),U(e.state)}}function Oe(t,r){if(t&1){let e=Y();o(0,"div",25),O("click",function(){L(e);let n=h(2);return P(n.profileOpen.set(!1))}),o(1,"div",26),m(2,"img",27),o(3,"p",28),s(4),a(),x(5,Te,2,3,"p",29),a(),o(6,"div",30),x(7,De,5,1,"div",31),o(8,"div",31)(9,"span",32),s(10,"Activit\xE9s"),a(),o(11,"span",33),s(12),a()(),o(13,"div",31)(14,"span",32),s(15,"Distance totale"),a(),o(16,"span",33),s(17),a()(),o(18,"div",31)(19,"span",32),s(20,"Temps total"),a(),o(21,"span",33),s(22),a()(),o(23,"div",31)(24,"span",32),s(25,"D\xE9nivel\xE9 total"),a(),o(26,"span",33),s(27),a()(),m(28,"hr",34),o(29,"button",35),O("click",function(n){L(e);let l=h(2);return P(l.logout(n))}),s(30," Se d\xE9connecter "),a()()()}if(t&2){let e=h(),i=h();p(2),q("src",e.profile,K)("alt",e.firstname),p(2),le("",e.firstname," ",e.lastname),p(),w(e.city||e.country?5:-1),p(2),w(e.state||e.country?7:-1),p(5),U(i.strava.activitiesCount()),p(5),F("",i.strava.totalDistanceKm()," km"),p(5),F("",i.strava.totalTimeHours()," h"),p(5),F("",i.strava.totalElevation()," m")}}function Ae(t,r){if(t&1){let e=Y();o(0,"div",18)(1,"button",19),O("click",function(){L(e);let n=h();return P(n.profileOpen.set(!n.profileOpen()))}),m(2,"img",20),o(3,"span",21),s(4),a(),C(),o(5,"svg",22),m(6,"path",23),a()(),x(7,Oe,31,10,"div",24),a()}if(t&2){let e=r,i=h();p(2),q("src",e.profile,K)("alt",e.firstname),p(2),U(e.firstname),p(),se("rotate-180",i.profileOpen()),p(2),w(i.profileOpen()?7:-1)}}var W=class t{strava=d(S);router=d(y);profileOpen=re(!1);onDocumentClick(r){r.target.closest(".relative")||this.profileOpen.set(!1)}logout(r){r.stopPropagation(),this.profileOpen.set(!1),this.strava.logout(),this.router.navigate(["/login"])}constructor(){V(()=>{this.strava.athlete()||this.strava.loadAthlete()})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=j({type:t,selectors:[["app-navbar"]],hostBindings:function(e,i){e&1&&O("click",function(l){return i.onDocumentClick(l)},oe)},decls:34,vars:1,consts:[[1,"bg-navy","text-white","shadow-xl"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6"],[1,"flex","items-center","justify-between","h-14","sm:h-16"],["routerLink","/",1,"flex","items-center","gap-2","sm:gap-3","text-lg","sm:text-xl","font-bold","tracking-tight"],[1,"text-xl","sm:text-2xl","bg-strava","rounded-lg","w-8","h-8","sm:w-9","sm:h-9","flex","items-center","justify-center","shadow-md","shrink-0"],[1,"hidden","sm:inline"],[1,"font-light","opacity-80"],[1,"sm:hidden"],[1,"flex","gap-0.5","sm:gap-1","bg-navy-light/50","rounded-xl","p-1"],["routerLink","/dashboard","routerLinkActive","!bg-strava !shadow-md",1,"px-2.5","sm:px-5","py-1.5","sm:py-2","rounded-lg","text-xs","sm:text-sm","font-medium","hover:bg-white/10","transition-all","duration-200","flex","items-center","gap-1.5"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","sm:hidden"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],["routerLink","/activities","routerLinkActive","!bg-strava !shadow-md",1,"px-2.5","sm:px-5","py-1.5","sm:py-2","rounded-lg","text-xs","sm:text-sm","font-medium","hover:bg-white/10","transition-all","duration-200","flex","items-center","gap-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],["routerLink","/progression","routerLinkActive","!bg-strava !shadow-md",1,"px-2.5","sm:px-5","py-1.5","sm:py-2","rounded-lg","text-xs","sm:text-sm","font-medium","hover:bg-white/10","transition-all","duration-200","flex","items-center","gap-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],["routerLink","/map","routerLinkActive","!bg-strava !shadow-md",1,"px-2.5","sm:px-5","py-1.5","sm:py-2","rounded-lg","text-xs","sm:text-sm","font-medium","hover:bg-white/10","transition-all","duration-200","flex","items-center","gap-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"relative"],[1,"flex","items-center","gap-2.5","cursor-pointer","hover:opacity-80","transition-opacity",3,"click"],[1,"w-8","h-8","rounded-full","ring-2","ring-white/20","object-cover",3,"src","alt"],[1,"hidden","sm:inline","text-sm","font-medium","opacity-90"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","opacity-60","hidden","sm:block","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"absolute","right-0","top-12","w-64","bg-white","rounded-2xl","shadow-xl","border","border-slate-200/60","overflow-hidden","z-50"],[1,"absolute","right-0","top-12","w-64","bg-white","rounded-2xl","shadow-xl","border","border-slate-200/60","overflow-hidden","z-50",3,"click"],[1,"bg-gradient-to-br","from-strava","to-orange-600","p-5","text-center","text-white"],[1,"w-16","h-16","rounded-full","ring-3","ring-white/30","mx-auto","mb-2","object-cover",3,"src","alt"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-80","mt-0.5"],[1,"p-4","space-y-2.5","text-sm","text-slate-600"],[1,"flex","justify-between"],[1,"text-slate-400"],[1,"font-semibold","text-slate-700"],[1,"border-slate-200","!my-3"],[1,"w-full","text-left","text-red-500","hover:text-red-600","font-medium","cursor-pointer","transition-colors",3,"click"]],template:function(e,i){if(e&1&&(o(0,"nav",0)(1,"div",1)(2,"div",2)(3,"a",3)(4,"span",4),s(5,"\u{1F3C3}"),a(),o(6,"span",5),s(7,"Strava "),o(8,"span",6),s(9,"Dashboard"),a()(),o(10,"span",7),s(11,"Strava"),a()(),o(12,"div",8)(13,"a",9),C(),o(14,"svg",10),m(15,"path",11),a(),D(),o(16,"span",5),s(17,"Dashboard"),a()(),o(18,"a",12),C(),o(19,"svg",10),m(20,"path",13),a(),D(),o(21,"span",5),s(22,"Activit\xE9s"),a()(),o(23,"a",14),C(),o(24,"svg",10),m(25,"path",15),a(),D(),o(26,"span",5),s(27,"Progression"),a()(),o(28,"a",16),C(),o(29,"svg",10),m(30,"path",17),a(),D(),o(31,"span",5),s(32,"Carte"),a()()(),x(33,Ae,8,6,"div",18),a()()()),e&2){let n;p(33),w((n=i.strava.athlete())?33:-1,n)}},dependencies:[ue,he],encapsulation:2})};function Ne(t,r){t&1&&m(0,"app-navbar")}var H=class t{strava=d(S);router=d(y);constructor(){V(()=>{this.handleOAuthCallback()})}async handleOAuthCallback(){let e=new URLSearchParams(window.location.search).get("code");if(!e)return;window.history.replaceState({},"",window.location.pathname),await this.strava.handleOAuthCallback(e)&&this.router.navigate(["/dashboard"])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=j({type:t,selectors:[["app-root"]],decls:4,vars:1,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-50","to-slate-100"],[1,"animate-fade-in"]],template:function(e,i){e&1&&(o(0,"div",0),x(1,Ne,1,0,"app-navbar"),o(2,"main",1),m(3,"router-outlet"),a()()),e&2&&(p(),w(i.strava.authenticated()?1:-1))},dependencies:[me,W],encapsulation:2})};de(H,Ce).catch(t=>console.error(t));
